!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("xterm"),require("@open-amt-cloud-toolkit/ui-toolkit/core"),require("@angular/cdk/keycodes"),require("@angular/router")):"function"==typeof define&&define.amd?define("sol",["exports","@angular/core","xterm","@open-amt-cloud-toolkit/ui-toolkit/core","@angular/cdk/keycodes","@angular/router"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).sol={},e.ng.core,e.xterm,e["@open-amt-cloud-toolkit"]["ui-toolkit"].core,e.ng.cdk.keycodes,e.ng.router)}(this,(function(e,t,n,o,r,i){"use strict";var s=function(){};s.ɵfac=function(e){return new(e||s)},s.ɵprov=t.ɵɵdefineInjectable({token:s,factory:s.ɵfac,providedIn:"root"}),("undefined"==typeof ngDevMode||ngDevMode)&&t.ɵsetClassMetadata(s,[{type:t.Injectable,args:[{providedIn:"root"}]}],(function(){return[]}),null);var a=function(){function e(e,n){this.params=e,this.activatedRoute=n,this.uuid="",this.server="",this.logger=new o.ConsoleLogger(o.LogLevel.ERROR),this.deviceStatus=new t.EventEmitter,this.deviceConnection=new t.EventEmitter,this.token=localStorage.getItem("loggedInUser")}return e.prototype.ngOnInit=function(){var e=this;this.activatedRoute.params.subscribe((function(t){e.uuid=t.id}))},e.prototype.init=function(){var e=this;this.terminal=new o.AmtTerminal,this.dataProcessor=new o.TerminalDataProcessor(this.terminal),this.redirector=new o.AMTRedirector(this.logger,o.Protocol.SOL,new FileReader,this.uuid,16994,"","",0,0,JSON.parse(this.token).token,this.server),this.terminal.onSend=this.redirector.send.bind(this.redirector),this.redirector.onNewState=this.terminal.StateChange.bind(this.terminal),this.redirector.onStateChanged=this.onTerminalStateChange.bind(this),this.redirector.onProcessData=this.dataProcessor.processData.bind(this),this.dataProcessor.processDataToXterm=this.handleWriteToXterm.bind(this),this.dataProcessor.clearTerminal=this.handleClearTerminal.bind(this),this.container=document.getElementById("terminal"),this.term=new n.Terminal({rows:30,cols:100,cursorStyle:"block",fontWeight:"bold"}),this.term.open(this.container),this.term.onData((function(t){e.handleKeyPress(t)})),this.term.attachCustomKeyEventHandler((function(t){return t.stopPropagation(),t.preventDefault(),!0===t.ctrlKey&&!0===t.shiftKey&&t.keyCode===r.C?navigator.clipboard.writeText(e.term.getSelection()):!0===t.ctrlKey&&!0===t.shiftKey&&t.keyCode===r.V?navigator.clipboard.readText().then((function(t){e.handleKeyPress(t)})):t.code===r.SPACE?e.handleKeyPress(t.key):void 0}))},e.prototype.handleKeyPress=function(e){this.terminal.TermSendKeys(e)},e.prototype.handleClearTerminal=function(){this.term.reset()},e.prototype.handleWriteToXterm=function(e){this.term.write(e)},e.prototype.onTerminalStateChange=function(e,t){this.deviceStatus.emit(t)},e.prototype.startSol=function(){this.redirector.start(WebSocket)},e.prototype.stopSol=function(){this.redirector.stop(),this.handleClearTerminal(),this.term.dispose(),this.cleanup()},e.prototype.cleanup=function(){this.terminal=null,this.redirector=null,this.dataProcessor=null,this.term=null},e.prototype.ngOnDestroy=function(){this.redirector.stop(),this.cleanup()},e}();a.ɵfac=function(e){return new(e||a)(t.ɵɵdirectiveInject("userInput"),t.ɵɵdirectiveInject(i.ActivatedRoute))},a.ɵcmp=t.ɵɵdefineComponent({type:a,selectors:[["amt-sol"]],inputs:{deviceConnection:"deviceConnection"},outputs:{deviceStatus:"deviceStatus"},decls:2,vars:0,consts:[[1,"container"],["id","terminal",1,"xtermDisplay",2,"width","fit-content"]],template:function(e,n){1&e&&(t.ɵɵelementStart(0,"div",0),t.ɵɵelement(1,"div",1),t.ɵɵelementEnd())},styles:['@import "xterm/css/xterm.css";.container{display:block;text-align:center}.xtermDisplay{display:inline-block}'],encapsulation:2}),("undefined"==typeof ngDevMode||ngDevMode)&&t.ɵsetClassMetadata(a,[{type:t.Component,args:[{selector:"amt-sol",templateUrl:"./sol.component.html",styleUrls:["./sol.component.css"],encapsulation:t.ViewEncapsulation.None}]}],(function(){return[{type:void 0,decorators:[{type:t.Inject,args:["userInput"]}]},{type:i.ActivatedRoute}]}),{deviceStatus:[{type:t.Output}],deviceConnection:[{type:t.Input}]});var c=function(){function e(){}return e.forRoot=function(t){return{ngModule:e,providers:[{provide:"userInput",useValue:t}]}},e}();c.ɵfac=function(e){return new(e||c)},c.ɵmod=t.ɵɵdefineNgModule({type:c}),c.ɵinj=t.ɵɵdefineInjector({imports:[[]]}),("undefined"==typeof ngJitMode||ngJitMode)&&t.ɵɵsetNgModuleScope(c,{declarations:[a],exports:[a]}),("undefined"==typeof ngDevMode||ngDevMode)&&t.ɵsetClassMetadata(c,[{type:t.NgModule,args:[{declarations:[a],imports:[],exports:[a]}]}],null,null),e.SolComponent=a,e.SolModule=c,e.SolService=s,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=sol.umd.min.js.map